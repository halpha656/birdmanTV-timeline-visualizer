# birdmanTV-timeline-visualizer
番組構成を可視化するタイムライン画像を生成します。

## 使い方

依存ライブラリ（Python 3.9+ 目安）:

- pandas
- matplotlib
- openpyxl

インストール例:

```bash
pip install -U pandas matplotlib openpyxl
```

実行例:

```bash
# シート名 2019 2021 2022 2023 の合成タイムラインを出力
python main.py --excel shaku2.xlsx --sheets 2019 2021 2022 2023 --out timeline.png

# CMも含めて描画（CMは濃い灰色、バー内に "CM" を縦に表示）
python main.py --excel shaku2.xlsx --sheets 2019 2021 2022 2023 --include-cm --out timeline_with_cm.png
```

オプション:

- `--excel`: 入力となるExcelファイルのパス（必須）
- `--sheets`: 可視化するシート名を空白区切りで列挙（必須）
- `--out`: 出力画像ファイル名（既定: `timeline.png`）
- `--include-cm`: CMセグメントも描画に含める（既定では除外）

描画仕様（抜粋）:

- 横軸は 0–7200 秒で固定、600 秒刻み。縦グリッド線を背景に表示。
- 「人力」「滑空」などの部門に応じて色分け（備考に `VTR` がある場合は濃色）。
- チーム名は棒の長さに入らない場合、外側に重ならないよう上下に段組みして注釈線で接続。
- 備考に`ダイジェスト`が連続する区間は「ダイジェスト: 計Nチーム」としてまとめて表示。
- `--include-cm`時のCMは濃い灰色(#9a9a9a)のバーで、バー内に`C\nM`を表示。外側注釈は付与しません。

## 入力Excelのフォーマット要件

各対象シートの1行目をヘッダとして以下の列を含めます（欠けている列は空として扱われます）。

- `尺`（必須）: セグメントの長さ（秒）。数値。0 以下は無視されます。
- `チーム`: チーム名（文字列）。同一チームが連続する場合は一つの区間としてまとめます。
- `部門`: 部門名（例: `人力`, `滑空`, など）。色分けに使用。
- `備考`: 備考欄。以下のキーワードを利用します。空欄可
	- `VTR`: 部門色を濃色に切り替え。
	- `ダイジェスト`: ダイジェスト区間として扱い、連続する行をまとめます。
	- `CM`: CM区間として扱い、既定では除外。`--include-cm`指定時は描画（注釈は外側に付けません）。

その他:

- シート内の行順がタイムライン順として扱われます。
- `尺`以外は欠損可。`尺`は数値化できない場合は無視されます。
- 出力は指定パスにPNGとして保存されます。
